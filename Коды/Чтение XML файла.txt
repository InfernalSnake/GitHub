//работа с XML файлами

&НаКлиенте
Процедура РедактированиеXMLДокумент(Команда)
	
	ПутьКФайлу = "z:\Users\Povarenkin\test.xml";
	ПрочитатьФайлXMLПоследовательноСпособ2(ПутьКФайлу);
	
КонецПроцедуры

&НаСервере
Функция ПостроитьПуть(СтекИмен)
    Путь = "";
 
    Для Каждого Имя Из СтекИмен Цикл
        Путь = Путь + "/" + Имя;
    КонецЦикла;
 
    Возврат Путь;
КонецФункции

&НаСервере
Процедура ПрочитатьФайлXMLПоследовательноСпособ2(ПутьКФайлу)
 
    // Этот способ подойдёт для очень больших файлов,
    // для которых модель DOM неприменима.
 
    // Способ 2.
 
    // Разбираем файл test.xml, ссылка на его скачивание выше.
 
    Парсер = Новый ЧтениеXML;
    Парсер.ОткрытьФайл(ПутьКФайлу);
 
    СтекИмен = Новый СписокЗначений;
 
    Пока Парсер.Прочитать() Цикл
        Если Парсер.ТипУзла = ТипУзлаXML.НачалоЭлемента Тогда
            СтекИмен.Добавить(Парсер.Имя);
            ПолныйПуть = ПостроитьПуть(СтекИмен);
 
            Если ПолныйПуть = "/Страны/Страна" Тогда
                Название = Парсер.ЗначениеАтрибута("Название");
                Если Название <> Неопределено Тогда
                    Сообщить("== " + Название + " ==");
                КонецЕсли;
 
                Численность = Парсер.ЗначениеАтрибута("Численность");
                Если Численность <> Неопределено Тогда
                    Сообщить("Численность: " + Численность);
                КонецЕсли;
 
                Столица = Парсер.ЗначениеАтрибута("Столица");
                Если Столица <> Неопределено Тогда
                    Сообщить("Столица: " + Столица);
                КонецЕсли;
            ИначеЕсли ПолныйПуть = "/Страны/Страна/ТрадиционныеБлюда" Тогда
                Сообщить("Традиционные блюда:");
            ИначеЕсли ПолныйПуть = "/Страны/Страна/ТрадиционныеБлюда/Блюдо" Тогда
                Название = Парсер.ЗначениеАтрибута("Название");
                Если Название <> Неопределено Тогда
                    Сообщить(" " + Название);
                КонецЕсли;
            ИначеЕсли ПолныйПуть = "/Страны/Страна/ОбщееОписание" Тогда
                Парсер.Прочитать();
                Если Парсер.ТипУзла = ТипУзлаXML.Текст Тогда
                    Сообщить("Общее описание:");
                    Сообщить(Парсер.Значение);
                КонецЕсли;
            КонецЕсли;
        ИначеЕсли Парсер.ТипУзла = ТипУзлаXML.КонецЭлемента Тогда
            СтекИмен.Удалить(СтекИмен.Количество() - 1);
        КонецЕсли;
    КонецЦикла;
 
    Парсер.Закрыть();
 
КонецПроцедуры